#Tool introduction
##Overview
Us3vmds (full name: US3 virtual metadata service) tool is a service component introduced to solve the problem of slow speed of Hadoop accessing ucloud objects to store US3 indexes. Because Hadoop's access to the distributed file system is based on the directory tree structure, and the index of object storage is only a simple kV structure, it directly simulates the moving directory and deleting directory of the directory tree through US3. Us3vmds builds a directory tree structure in memory based on the storage space index of US3, so that the client can realize complex logic through a single interaction, and can use the full memory index to accelerate operations such as getfilestatus and liststatus of Hadoop on the distributed file system.
##Principle description
Us3vmds implements several APIs such as head, put, listobjects, delete, rename and copy used by the US3 adapter to process index requests, and builds a directory tree in memory, whose location is similar to the namenode implemented by HDFS. The US3 adapter IO request is sent directly to US3, but the us3vmds will be notified after the write IO is successful (the delay is about 150us, and the impact can be ignored). The whole architecture is shown in the figure below.
! [](/images/hadoop_mds_model.png)
Us3vmds with version greater than or equal to v0.1.0 also supports high availability cluster deployment. There is a primary node and multiple standby nodes in the cluster at the same time. The primary node will normally provide caching services as described above, while the standby node will only process index requests, but will not cache the results in memory. Each node in the cluster and the us3hadoop adapter will monitor the information changes of the us3vmds node in zookeeper. Once the primary node is found offline (the primary node crashes, the network is not connected, etc.), a standby node will be promoted to the primary node to provide caching services. The architecture is shown in the following figure:
! []( http://us3-release.cn-bj.ufileos.com/us3-bigdata/us3-vmds/static/images/vmds.jpg )
This architecture is suitable for accelerated backup scenarios and small and medium-sized computing analysis scenarios.
##Operating environment
- Linux
- Mac